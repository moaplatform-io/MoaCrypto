const MoaClientCoreAuthLib=function(){const e="00FF0000FF00FF000000FFFF000000FF",t=(t,n)=>{const c=CryptoJS.SHA256(CryptoJS.AES.encrypt(n,CryptoJS.enc.Hex.parse(CryptoJS.SHA256(t).toString().substring(0,e.length)),{iv:CryptoJS.enc.Hex.parse(e)}).ciphertext),o=CryptoJS.HmacSHA256(t,c);return CryptoJS.enc.Utf8.parse(t).toString(CryptoJS.enc.Base64).concat("$").concat(c.toString(CryptoJS.enc.Base64)).concat("$").concat(o.toString(CryptoJS.enc.Base64))};return{MANAGER_ADMIN:"0x61",MANAGER_TOP:"0x62",MANAGER_GENERAL:"0x63",coreMsgPacketParser:e=>{const t=e.indexOf("$");return-1===t?"":(e=>0==e.indexOf("4D4F410002")||0==e.indexOf("4D4F410004")||0==e.indexOf("4D4F410014")||0==e.indexOf("4D4F412002")||0==e.indexOf("4D4F412004")||0==e.indexOf("4D4F412014")||0==e.indexOf("4D4F413002")||0==e.indexOf("4D4F413008"))(e.substring(0,t).toUpperCase())?e.substring(t+1,e.length):""},coreIdExistRegistRequestMsgGenProcess:e=>"4D4F410001".concat("$").concat(CryptoJS.enc.Utf8.parse(e).toString(CryptoJS.enc.Base64)),coreIdPswRegistRequestMsgGenProcess:(e,n,c)=>null===e?"4D4F410003".concat("$").concat(t(n,c)):"4D4F410013".concat("$").concat(e).concat("$").concat(t(n,c)),coreIdPswLogInStartRequestMsgGenProcess:()=>"4D4F412001",coreIdPswLogInRequestMsgGenProcess:(e,n,c,o)=>o?"4D4F412013".concat("$").concat(t(e,n)).concat("$").concat(c):"4D4F412003".concat("$").concat(t(e,n)).concat("$").concat(c),coreIdPswChangePswRequestMsgGenProcess:(e,n,c)=>{const o=t(e,c);return"4D4F413001".concat("$").concat(t(e,n)).concat("$").concat(o.substring(o.indexOf("$")+1,o.length))},coreIdPswUnRegistRequestMsgGenProcess:e=>"4D4F413007".concat("$").concat(CryptoJS.enc.Utf8.parse(e).toString(CryptoJS.enc.Base64)),generateSign:e=>{const t=MoaECDSACoreAPI.doGenerate("secp256r1");return MoaECDSACoreAPI.doSign("secp256r1","SHA256withECDSA",e,t.ecprvhex)},generateWalletRegistMsg:(e,t,n)=>{const c=n.split("%"),o=c[1].split("$"),r=CryptoJS.enc.Hex.parse(CryptoJS.enc.Base64.parse(c[0]).toString(CryptoJS.enc.Hex)),s=CryptoJS.enc.Hex.parse(CryptoJS.enc.Base64.parse(o[1]).toString(CryptoJS.enc.Hex)),a=CryptoJS.enc.Hex.parse(CryptoJS.enc.Base64.parse(o[2]).toString(CryptoJS.enc.Hex));return"4D4F414003".concat("$").concat(CryptoJS.enc.Utf8.parse(e).toString(CryptoJS.enc.Base64)).concat("$").concat(CryptoJS.enc.Hex.parse(t).toString(CryptoJS.enc.Base64)).concat("$").concat(o[0]).concat("$").concat(s.concat(r).concat(a).toString(CryptoJS.enc.Base64))},verifyRegisterWalletMsg:e=>{const t=e.split("$");return t[0].indexOf("4D4F414004")>-1&&t[1].indexOf("6080")>-1},generateRestoreWalletMsg:e=>"4D4F414007".concat("$").concat(CryptoJS.enc.Utf8.parse(e).toString(CryptoJS.enc.Base64)),verifyRestoreWalletMsg:e=>{const t=e.split("$");return t[0].indexOf("4D4F414008")>-1&&t[1].indexOf("6084")>-1}}}();